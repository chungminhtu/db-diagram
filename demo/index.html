<html>

<head>
   <style>
      body,
      html {
         padding: 0;
         margin: 0;
      }
   </style>
</head>

<body>
   <script src="browser/db-diagram.default.js"></script>
   <div id="mydiv" style="width: 100%; height:100%;"></div>
   <script>
      const initialDiagram = (diagram, data) => {
         let tables = [];
         data.forEach(tbOpt => {
            const fields = tbOpt.fields;
            delete tbOpt.fields;
            const table = diagram.table(tbOpt);
            fields.forEach((field) => { table.addField(field) });
            tables.push(table);
         });

         tables[0].x(100).y(50);
         tables[1].x(450).y(120);
         tables[2].x(50).y(320);

         const relation1 = new DBDiagram.Relation(diagram, {
            primaryTable: tables[0],
            foreignTable: tables[1],
            line: true,
            weak: true
         });

         const relation2 = new DBDiagram.Relation(diagram, {
            primaryTable: tables[2],
            foreignTable: tables[1],
            line: true,
            weak: true
         });
      };

      DBDiagram.onDomReady(() => {
         const diagram = new DBDiagram.Diagram().attach("#mydiv");

         fetch(new Request("diagram.json")).then((response) => {
            if (response.ok) {
               return response.json();
            } else {
               console.log("Fetch failed");
            }
         }).then((json) => {
            initialDiagram(diagram, json);
         });
      });
   </script>
</body>

</html>